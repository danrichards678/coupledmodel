from fenics import*
import numpy as np


def idx(l,m):
    return ((l*l)//4 + m)

def a2(f,ndim=2):

    a00 = 0.333333333333333333*f[idx(0,0)].sub(0) -0.14907119849998597976*f[idx(2,0)].sub(0) +2*0.18257418583505537115*f[idx(2,2)].sub(0)
    a01 = -2*0.18257418583505537115*f[idx(2,2)].sub(1)
    a10 = a01
    a02=2*((-0.18257418583505537115))*f[idx(2,1)].sub(0)
    a20=a02
    a11=((0.33333333333333333333))*f[idx(0,0)].sub(0)+ ((-0.14907119849998597976))*f[idx(2,0)].sub(0)+ 2*((-0.18257418583505537115))*f[idx(2,2)].sub(0)
    a12=-2*((-0.18257418583505537115))*f[idx(2,1)].sub(1)
    a21=a12
    a22=((0.33333333333333333333))*f[idx(0,0)].sub(0)+ ((0.29814239699997195952))*f[idx(2,0)].sub(0)
    
    if ndim==2:
        a = as_matrix([[a00, a01],[a10, a11]])
    
    if ndim==3:
        a = as_matrix([[a00, a01, a02],[a10, a11, a12],[a20, a21, a22]])


    return a


def a4(f,ndim=2):

    a4list = []
    for i in range(0,ndim):
        a4list += [[],]
        for j in range(0,ndim):
            a4list[i] += [[],]
            for k in range(0,ndim):
                a4list[i][j] += [[],]
                for l in range(0,ndim):
                    a4list[i][j][k] += [[],]

    a4list[0][0][0][0] =((0.2))*f[idx(0,0)].sub(0)\
                        + ((-0.12777531299998798265))*f[idx(2,0)].sub(0)\
                        + 2*((0.15649215928719031813))*f[idx(2,2)].sub(0)\
                        + ((0.028571428571428571429))*f[idx(4,0)].sub(0)\
                        + 2*((-0.030116930096841707924))*f[idx(4,2)].sub(0)\
                        + 2*((0.039840953644479787999))*f[idx(4,4)].sub(0)
        
    a4list[1][0][0][0]=-2*((0.078246079643595159065))*f[idx(2,2)].sub(1)\
                        - 2*((-0.015058465048420853962))*f[idx(4,2)].sub(1)\
                        - 2*((0.039840953644479787999))*f[idx(4,4)].sub(1)
    a4list[0][1][0][0]=a4list[1][0][0][0]
    a4list[0][0][1][0]=a4list[1][0][0][0]
    a4list[0][0][0][1]=a4list[1][0][0][0]

    a4list[1][1][0][0]=((0.066666666666666666667))*f[idx(0,0)].sub(0)\
                        + ((-0.042591770999995994217))*f[idx(2,0)].sub(0)\
                        + ((0.0095238095238095238095))*f[idx(4,0)].sub(0)\
                        + 2*((-0.039840953644479787999))*f[idx(4,4)].sub(0)
    a4list[1][0][1][0]=a4list[1][1][0][0]
    a4list[1][0][0][1]=a4list[1][1][0][0]
    a4list[0][1][1][0]=a4list[1][1][0][0]
    a4list[0][1][0][1]=a4list[1][1][0][0]
    a4list[0][0][1][1]=a4list[1][1][0][0]

    a4list[1][1][1][0]=-2*((0.078246079643595159065))*f[idx(2,2)].sub(1)\
                        - 2*((-0.015058465048420853962))*f[idx(4,2)].sub(1)\
                        - 2*((-0.039840953644479787999))*f[idx(4,4)].sub(1)
    a4list[1][1][0][1]=a4list[1][1][1][0]
    a4list[1][0][1][1]=a4list[1][1][1][0]
    a4list[0][1][1][1]=a4list[1][1][1][0]

    a4list[1][1][1][1]=((0.2))*f[idx(0,0)].sub(0)\
                            + ((-0.12777531299998798265))*f[idx(2,0)].sub(0)\
                            + 2*((-0.15649215928719031813))*f[idx(2,2)].sub(0)\
                            + ((0.028571428571428571429))*f[idx(4,0)].sub(0)\
                            + 2*((0.030116930096841707924))*f[idx(4,2)].sub(0)\
                            + 2*((0.039840953644479787999))*f[idx(4,4)].sub(0)


    if ndim==3:
        a4list[2][0][0][0]=2*((-0.078246079643595159065))*f[idx(2,1)].sub(0)\
                    + 2*((0.031943828249996995663))*f[idx(4,1)].sub(0)\
                    + 2*((-0.028171808490950552584))*f[idx(4,3)].sub(0)
        a4list[0][2][0][0]=a4list[2][0][0][0]
        a4list[0][0][2][0]=a4list[2][0][0][0]
        a4list[0][0][0][2]=a4list[2][0][0][0]

        a4list[2][1][0][0]=-2*((-0.026082026547865053022))*f[idx(2,1)].sub(1)\
                        - 2*((0.010647942749998998554))*f[idx(4,1)].sub(1)\
                        - 2*((-0.028171808490950552584))*f[idx(4,3)].sub(1)
        a4list[2][0][1][0]=a4list[2][1][0][0]
        a4list[2][0][0][1]=a4list[2][1][0][0]
        a4list[1][2][0][0]=a4list[2][1][0][0]
        a4list[1][0][2][0]=a4list[2][1][0][0]
        a4list[1][0][0][2]=a4list[2][1][0][0]
        a4list[0][2][1][0]=a4list[2][1][0][0]
        a4list[0][2][0][1]=a4list[2][1][0][0]
        a4list[0][1][2][0]=a4list[2][1][0][0]
        a4list[0][1][0][2]=a4list[2][1][0][0]
        a4list[0][0][2][1]=a4list[2][1][0][0]
        a4list[0][0][1][2]=a4list[2][1][0][0]

        a4list[2][2][0][0]=((0.066666666666666666667))*f[idx(0,0)].sub(0)\
                            + ((0.021295885499997997109))*f[idx(2,0)].sub(0)\
                            + 2*((0.026082026547865053022))*f[idx(2,2)].sub(0)\
                            + ((-0.038095238095238095238))*f[idx(4,0)].sub(0)\
                            + 2*((0.030116930096841707924))*f[idx(4,2)].sub(0)
        a4list[2][0][2][0]=a4list[2][2][0][0]
        a4list[2][0][0][2]=a4list[2][2][0][0]
        a4list[0][2][2][0]=a4list[2][2][0][0]
        a4list[0][2][0][2]=a4list[2][2][0][0]
        a4list[0][0][2][2]=a4list[2][2][0][0]

        a4list[2][1][1][0]=2*((-0.026082026547865053022))*f[idx(2,1)].sub(0)\
                            + 2*((0.010647942749998998554))*f[idx(4,1)].sub(0)\
                            + 2*((0.028171808490950552584))*f[idx(4,3)].sub(0)
        a4list[2][1][0][1]=a4list[2][1][1][0]
        a4list[2][0][1][1]=a4list[2][1][1][0]
        a4list[1][2][1][0]=a4list[2][1][1][0]
        a4list[1][2][0][1]=a4list[2][1][1][0]
        a4list[1][1][2][0]=a4list[2][1][1][0]
        a4list[1][1][0][2]=a4list[2][1][1][0]
        a4list[1][0][2][1]=a4list[2][1][1][0]
        a4list[1][0][1][2]=a4list[2][1][1][0]
        a4list[0][2][1][1]=a4list[2][1][1][0]
        a4list[0][1][2][1]=a4list[2][1][1][0]
        a4list[0][1][1][2]=a4list[2][1][1][0]                    

        a4list[2][2][1][0]=-2*((0)+(0.026082026547865053022))*f[idx(2,2)].sub(1)\
                        - 2*((0)+(0.030116930096841707924))*f[idx(4,2)].sub(1)
        a4list[2][2][0][1]=a4list[2][2][1][0]
        a4list[2][1][2][0]=a4list[2][2][1][0]
        a4list[2][1][0][2]=a4list[2][2][1][0]
        a4list[2][0][2][1]=a4list[2][2][1][0]
        a4list[2][0][1][2]=a4list[2][2][1][0]
        a4list[1][2][2][0]=a4list[2][2][1][0]
        a4list[1][2][0][2]=a4list[2][2][1][0]
        a4list[1][0][2][2]=a4list[2][2][1][0]
        a4list[0][2][2][1]=a4list[2][2][1][0]
        a4list[0][2][1][2]=a4list[2][2][1][0]
        a4list[0][1][2][2]=a4list[2][2][1][0]


        a4list[2][2][2][0]=2*((-0.078246079643595159065))*f[idx(2,1)].sub(0)\
                            + 2*((-0.042591770999995994217))*f[idx(4,1)].sub(0)
        a4list[2][2][0][2]=a4list[2][2][2][0]
        a4list[2][0][2][2]=a4list[2][2][2][0]
        a4list[0][2][2][2]=a4list[2][2][2][0]


        
        a4list[2][1][1][1]=-2*((-0.078246079643595159065))*f[idx(2,1)].sub(1)\
                            - 2*((0.031943828249996995663))*f[idx(4,1)].sub(1)\
                            - 2*((0.028171808490950552584))*f[idx(4,3)].sub(1)
        a4list[1][2][1][1]=a4list[2][1][1][1]
        a4list[1][1][2][1]=a4list[2][1][1][1]
        a4list[1][1][1][2]=a4list[2][1][1][1]

        a4list[2][2][1][1]=((0.066666666666666666667))*f[idx(0,0)].sub(0)\
                            + ((0.021295885499997997109))*f[idx(2,0)].sub(0)\
                            + 2*((-0.026082026547865053022))*f[idx(2,2)].sub(0)\
                            + ((-0.038095238095238095238))*f[idx(4,0)].sub(0)\
                            + 2*((-0.030116930096841707924))*f[idx(4,2)].sub(0)
        a4list[2][1][2][1]=a4list[2][2][1][1]
        a4list[2][1][1][2]=a4list[2][2][1][1]
        a4list[1][2][2][1]=a4list[2][2][1][1]
        a4list[1][2][1][2]=a4list[2][2][1][1]
        a4list[1][1][2][2]=a4list[2][2][1][1]                    

        a4list[2][2][2][1]=-2*((-0.078246079643595159065))*f[idx(2,1)].sub(1)\
                            - 2*((-0.042591770999995994217))*f[idx(4,1)].sub(1)
        a4list[2][2][1][2]=a4list[2][2][2][1]
        a4list[2][1][2][2]=a4list[2][2][2][1]
        a4list[1][2][2][2]=a4list[2][2][2][1]

        a4list[2][2][2][2]=((0.2))*f[idx(0,0)].sub(0)\
                            + ((0.2555506259999759653))*f[idx(2,0)].sub(0)\
                            + ((0.076190476190476190476))*f[idx(4,0)].sub(0)

    
    
    return as_tensor(a4list)
        
       

    
       
       
        
    

       
        
       
        
        
        

       

        
       
        



